# CUDA

## 初识

.cu 文件 一般即包含cpu程序(主机程序host)也包含gpu程序(设备程序device)。

凡是挂有`__global__`或者`__device__`前缀的函数都是gpu上运行的设备程序，不同的是`__global__`设备程序可被主机程序调用，而`__device__`设备程序只能被设备程序调用。

**没有挂任何前缀的函数，都是主机程序**

## cudaMemcpyAsync()

cudaMemcpyAsync()在GPU与主机之间复制数据

在调用cudaMemcpyAsync()时，只是放置一个请求，表示在流中执行一次内存复制操作，这个流是通过参数stream来指定的。当函数返回时，我们无法确保复制操作是否已经启动或完成。我们能够保证的是复制操作肯定会在下一个被放入流中的操作启动之前执行。任何传递给cudaMemcpyAsync()的主机内存指针都必须已经通过cudaHostAlloc()分配好内存，也就是，只能以异步方式对页锁定内存进行复制操作。

